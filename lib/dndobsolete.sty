\ExplSyntaxOn

%% Environment inline comments
\NewDocumentEnvironment { commentbox } { o m o }
  {
    \dnd@deprecate { commentbox } { 1.0 } [ Use~DndComment~for~inline~comment~boxes. ]

    \tl_if_novalue:nTF { #3 }
      { \begin { DndComment } [ #1 ] { #2 } }
      { \begin { DndComment } [ #1, color = #3 ] { #2 } }
  }
  {
    \end { DndComment }
  }

%% Environment for read-aloud text
\NewDocumentEnvironment { quotebox } { o o }
{
  \dnd@deprecate { quotebox } { 1.0 } [ Use~DndReadAloud~for~read-aloud~text. ]

  \tl_if_novalue:nTF { #2 }
    { \begin { DndReadAloud } [ #1 ] }
    { \begin { DndReadAloud } [ #1, color = #2 ] }
}
{ \end { DndReadAloud} }
  
%% Environment for sidebars
\NewDocumentEnvironment { paperbox } { o m o }
{
  \dnd@deprecate { paperbox } { 1.0 } [ Use~DndComment~for~inline~comment~boxes. ]

  \tl_if_novalue:nTF { #3 }
    { \begin { DndSidebar } [ #1 ] { #2 } }
    { \begin { DndSidebar } [ #1, color = #3 ] { #2 } }
}
{ \end { DndSidebar } }

%% Backwards-compatible colour aliases to be removed in 1.0.0
\colorlet{commentboxcolor}{commentcolor}
\colorlet{paperboxcolor}{sidebarcolor}
\colorlet{quoteboxcolor}{readaloudcolor}
\colorlet{commentgreen}{PhbLightGreen}
\colorlet{itemtablepink}{DmgCoral}
\colorlet{monstertan}{statblockbg}
\definecolor{monstertandark}{HTML}{F0DBB5}

\ExplSyntaxOff