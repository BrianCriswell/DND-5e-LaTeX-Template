\ExplSyntaxOn

% Centered Column
\newcolumntype { Y }
  { > { \centering \arraybackslash } X }

\keys_define:nn { dnd / table }
  {
    color .tl_set:N         = \l__dnd_table_color_tl,
    color .initial:n        = tablecolor,
    color .value_required:n = true,
    header .tl_set:N         = \l__dnd_table_header_tl,
    header .value_required:n = true,
    width .dim_set:N        = \l__dnd_table_width_dim,
    width .value_required:n = true,
  }

\NewDocumentEnvironment {DndTable} { O{} m }
  {
    \group_begin:

    \tl_if_novalue:nF {#1}
      { \keys_set:nn { dnd / table } {#1} }

    \dim_compare:nNnT {\l__dnd_table_width_dim} = {\c_zero_dim}
      { \dim_set:Nn \l__dnd_table_width_dim {\linewidth} }

    \par \vspace {8pt} \noindent

    \tl_if_empty:NF \l__dnd_table_header_tl
      {
        \group_begin:
          \l__dnd_font_table_title_tl \l__dnd_table_header_tl
          \par \smallskip \noindent
        \group_end:
      }

    \l__dnd_font_table_body_tl

    \rowcolors {1} {} {\l__dnd_table_color_tl}

    \tabularx {\l__dnd_table_width_dim} {#2}
  }
  {
    \endtabularx \vspace { 8pt plus 1pt }

    \group_end:
  }
