\ExplSyntaxOn

% Centered Column
\newcolumntype { Y }
  { > { \centering \arraybackslash } X }

\keys_define:nn { dnd / table }
  {
    color .tl_set:N         = \l__dnd_table_color_tl,
    color .initial:n        = tablecolor,
    color .value_required:n = true,
    header .tl_set:N         = \l__dnd_table_header_tl,
    header .value_required:n = true,
    width .dim_set:N        = \l__dnd_table_width_dim,
    width .initial:n        = \linewidth,
    width .value_required:n = true,
  }

\NewDocumentEnvironment { DndTable } { o m }
  {
    \group_begin:
    
    \tl_if_novalue:nF { #1 }
      { \keys_set:nn { dnd / table } { #1 } }
    
    \par \bigskip \noindent

    \tl_if_empty:NF \l__dnd_table_header_tl
      {
        \group_begin:
          \dnd@TableTitleFont \l__dnd_table_header_tl
          \par \smallskip \noindent
        \group_end:
      }

    \dnd@TableBodyFont
    
    \rowcolors { 1 } {} { \l__dnd_table_color_tl }
    
    \tabularx { \l__dnd_table_width_dim } { #2 }
  }
  {
    \endtabularx \bigskip
    
    \group_end:
  }

\ExplSyntaxOff